<html>
<head>
	<meta charset="UTF-8">
    <title>Chat Room</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.0/socket.io.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>

<h1>Welcome {{username}}</h1>
<ul id="messages"></ul>
<input type="text" id="myMessage">
<button id="sendbutton">Send</button>
<style type="text/css">
	table, th, td{
		border: 1px solid black;
	}
</style>

<a href="/logout/{{username}}">Logout</a>

<script>
    $(document).ready(function() {
	var socket = io.connect('http://127.0.0.1:5000');
    var currentUserName = "{{username}}";

	socket.on('connect', function() {
			const meInfo = {"Type": "Socket", "Id": socket.id, "Username": currentUserName}
		    socket.send(JSON.stringify(meInfo));
	});

	socket.on('message', function(msg) {
		$("#messages").append('<li>'+msg+'</li>');
		console.log('Received message');
	});

	$('#sendbutton').on('click', function() {
        console.log('Send message');
		msg = $('#myMessage').val();
		$("#messages").append('<li>'+msg+'</li>');
	    const meInfo = {"Type": "Post", "From": currentUserName, "To": "broadcast", "Content": msg};
		socket.send(JSON.stringify(meInfo));
		$('#myMessage').val('');
	});
	});
</script>
<!--<script type="text/javascript" src="../static/home.js"></script>-->

</body>


</html>
